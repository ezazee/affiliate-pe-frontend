{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/game/affiliate-growth-hub/src/lib/mongodb.ts"],"sourcesContent":["import { MongoClient } from 'mongodb';\n\nconst uri = process.env.MONGODB_URI;\nconst options = {};\n\nif (!uri) {\n  throw new Error('Please add your Mongo URI to .env.local');\n}\n\nlet client: MongoClient;\nlet clientPromise: Promise<MongoClient>;\n\nif (process.env.NODE_ENV === 'development') {\n  // In development mode, use a global variable so that the value\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\n  if (!global._mongoClientPromise) {\n    client = new MongoClient(uri, options);\n    global._mongoClientPromise = client.connect();\n  }\n  clientPromise = global._mongoClientPromise;\n} else {\n  // In production mode, it's best to not use a global variable.\n  client = new MongoClient(uri, options);\n  clientPromise = client.connect();\n}\n\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\nexport default clientPromise;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU,CAAC;AAEjB,IAAI,CAAC,KAAK;IACR,MAAM,IAAI,MAAM;AAClB;AAEA,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,IAAI,CAAC,yDAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,oKAAW,CAAC,KAAK;QAC9B,yDAAO,mBAAmB,GAAG,OAAO,OAAO;IAC7C;IACA,gBAAgB,yDAAO,mBAAmB;AAC5C;;uCAQe"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///D:/game/affiliate-growth-hub/src/app/api/affiliator/stats/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport clientPromise from '@/lib/mongodb';\nimport { Order, Commission, AffiliateLink } from '@/types';\n\nexport async function GET(req: NextRequest) {\n  const { searchParams } = new URL(req.url);\n  const affiliatorId = searchParams.get('affiliatorId');\n\n  if (!affiliatorId) {\n    return NextResponse.json({ error: 'affiliatorId is required' }, { status: 400 });\n  }\n\n  try {\n    const client = await clientPromise;\n    const db = client.db();\n\n    const userOrders = (await db.collection<Order>('orders').find({ affiliatorId }).toArray()).map(order => ({ ...order, id: order._id.toString() }));\n    const userCommissions = (await db.collection<Commission>('commissions').find({ affiliatorId }).toArray()).map(commission => ({ ...commission, id: commission._id.toString() }));\n    const userLinks = (await db.collection<AffiliateLink>('affiliateLinks').find({ affiliatorId }).toArray()).map(link => ({ ...link, id: link._id.toString() }));\n\n    const totalRevenue = userOrders.reduce((sum, order) => sum + (order.shippingCost || 0), 0);\n    const totalCommissions = userCommissions.reduce((sum, commission) => sum + commission.amount, 0);\n    const conversionRate = userOrders.length > 0 && userLinks.length > 0 ? (userOrders.length / userLinks.length) * 100 : 0;\n    \n    return NextResponse.json({\n      totalRevenue,\n      totalCommissions,\n      totalOrders: userOrders.length,\n      conversionRate: conversionRate.toFixed(2),\n    });\n  } catch (error) {\n    return NextResponse.json({ error: 'Something went wrong' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,IAAI,GAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,eAAe,aAAa,GAAG,CAAC;IAEtC,IAAI,CAAC,cAAc;QACjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;IAEA,IAAI;QACF,MAAM,SAAS,MAAM,kIAAa;QAClC,MAAM,KAAK,OAAO,EAAE;QAEpB,MAAM,aAAa,CAAC,MAAM,GAAG,UAAU,CAAQ,UAAU,IAAI,CAAC;YAAE;QAAa,GAAG,OAAO,EAAE,EAAE,GAAG,CAAC,CAAA,QAAS,CAAC;gBAAE,GAAG,KAAK;gBAAE,IAAI,MAAM,GAAG,CAAC,QAAQ;YAAG,CAAC;QAC/I,MAAM,kBAAkB,CAAC,MAAM,GAAG,UAAU,CAAa,eAAe,IAAI,CAAC;YAAE;QAAa,GAAG,OAAO,EAAE,EAAE,GAAG,CAAC,CAAA,aAAc,CAAC;gBAAE,GAAG,UAAU;gBAAE,IAAI,WAAW,GAAG,CAAC,QAAQ;YAAG,CAAC;QAC7K,MAAM,YAAY,CAAC,MAAM,GAAG,UAAU,CAAgB,kBAAkB,IAAI,CAAC;YAAE;QAAa,GAAG,OAAO,EAAE,EAAE,GAAG,CAAC,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,IAAI,KAAK,GAAG,CAAC,QAAQ;YAAG,CAAC;QAE3J,MAAM,eAAe,WAAW,MAAM,CAAC,CAAC,KAAK,QAAU,MAAM,CAAC,MAAM,YAAY,IAAI,CAAC,GAAG;QACxF,MAAM,mBAAmB,gBAAgB,MAAM,CAAC,CAAC,KAAK,aAAe,MAAM,WAAW,MAAM,EAAE;QAC9F,MAAM,iBAAiB,WAAW,MAAM,GAAG,KAAK,UAAU,MAAM,GAAG,IAAI,AAAC,WAAW,MAAM,GAAG,UAAU,MAAM,GAAI,MAAM;QAEtH,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB;YACA;YACA,aAAa,WAAW,MAAM;YAC9B,gBAAgB,eAAe,OAAO,CAAC;QACzC;IACF,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}